<%- include('partials/header') %>
<div class="container mt-5">
  <h1>Register</h1>

  <div class="row">
    <div class="col-sm-8">
      <div class="card">
        <div class="card-body">

          <!-- Makes POST request to /register route -->
          <form action="/register" method="POST" id="loginForm">
            <div class="form-group">
              <label for="fname">First Name</label>
              <input type="text" class="form-control" name="fname">
            </div>
            <div class="form-group">
              <label for="lname">Last Name</label>
              <input type="text" class="form-control" name="lname">
            </div>
            <div class="form-group">
              <label for="email">Email<span style="color: red;">*</span></label>
              <input type="email" class="form-control" name="email" required>
            </div>
            <div class="form-group">
              <label for="password">Password<span style="color: red;">*</span></label>
              <input type="password" class="form-control" name="password" required id="password">
              <small id="passwordLen" class="form-text text-muted"></small>
            </div>
            <div class="form-group">
              <label for="confirmPassword">Confirm Password<span style="color: red;">*</span></label>
              <input type="password" class="form-control" name="confirmPassword" required id="confirmPassword">
              <small id="passwordHelp" class="form-text text-muted"></small>
            </div>
            <button type="submit" class="btn btn-dark" id="registerbtn">Register</button>
          </form>
        </div>
      </div>
    </div>
<%- include('partials/footer') %>

<script>
  document.addEventListener('DOMContentLoaded', (event) => {
    const password = document.getElementById('password');
    const confirmPassword = document.getElementById('confirmPassword');
    const passwordHelp = document.getElementById('passwordHelp');
    const registerbtn = document.getElementById('registerbtn');
    const form = document.getElementById('loginForm');
    const passwordLen = document.getElementById('passwordLen');

    function validatePassword() {
      if (password.value !== confirmPassword.value) {
        passwordHelp.textContent = 'Passwords do not match';
        passwordHelp.style.color = 'red';
        registerbtn.disabled = true;
      } 
      else {
        passwordHelp.textContent = 'Passwords match';
        passwordHelp.style.color = 'green';
        registerbtn.disabled = false;
      }
    }

    function checkPasswordLength(){
      if(password.value.length < 8){
        passwordLen.textContent = 'Password must be 8 characters or longer';
        passwordLen.style.color = 'red';
        registerbtn.disabled = true;
      }
      else{
        passwordLen.textContent = '';
        registerbtn.disabled = false;
      }
    }

    password.addEventListener('input', validatePassword);
    password.addEventListener('input', checkPasswordLength);
    confirmPassword.addEventListener('input', validatePassword);

    form.addEventListener('submit', (event) => {
      if (password.value !== confirmPassword.value) {
        event.preventDefault();
        alert('Passwords do not match');
      }
      else if(password.value.length < 8){
        event.preventDefault();
        alert('Password must be 8 characters or longer')
      }
    });
  });
</script>
